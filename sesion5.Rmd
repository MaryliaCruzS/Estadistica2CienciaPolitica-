---
title: "An√°lisis Factorial"
output: html_document
---

# An√°lisis Factorial

<center><img src=" " width="200"/></center>

**FACULTAD DE CIENCIAS SOCIALES - PUCP**<br>

## Curso: POL 304 - Estad√≠stica para el an√°lisis pol√≠tico 2 \| Semestre 2025 - 1 <br>

## Docente: Marylia Cruz <br>

------------------------------------------------------------------------

El An√°lisis Factorial  es una t√©cnica estad√≠stica multivariada que permite identificar estructuras latentes (factores) que subyacen a un conjunto de variables observadas (por ejemplo, √≠tems de un cuestionario).


- Objetivo: reducir la dimensionalidad, identificar grupos de variables correlacionadas, y entender la estructura interna de los datos.


## **üîç 1. An√°lisis Factorial Exploratorio (AFE)**


Es una t√©cnica exploratoria, que se usa cuando no se conoce la estructura de factores que subyace a las variables. Es decir, no hay una hip√≥tesis previa sobre cu√°ntos factores hay ni qu√© √≠tems pertenecen a qu√© factor.

- üéØ Objetivo:

Descubrir la estructura latente detr√°s de un conjunto de variables observadas.

- üß™ ¬øCu√°ndo se usa?

En etapas iniciales del desarrollo de un instrumento.

Cuando no hay un modelo te√≥rico claro.

Para reducir la dimensionalidad de un conjunto de √≠tems.

- üß∞ M√©todos comunes:

-Extracci√≥n: componentes principales, m√≠nimos cuadrados, m√°xima verosimilitud.

- Rotaci√≥n: Varimax (ortogonal), Promax (oblicua).

- Evaluaci√≥n: KMO, test de esfericidad de Bartlett, scree plot, autovalores > 1.

- üì¶ Ejemplo:

Est√°s creando una escala para medir "actitudes hacia la ciencia". Usas AFE para ver si tus √≠tems se agrupan en 2 factores (por ejemplo, ciencia y tecnolog√≠a), sin haber definido eso previamente.

- **Etapas o pasos del AEF**

-  **1. Verificaci√≥n de adecuaci√≥n de datos **

- Correlaciones entre variables.
- Pruebas: KMO y Bartlett.

-  **2. Extracci√≥n de factores **

- M√©todo m√°s com√∫n: An√°lisis de componentes principales (PCA) o an√°lisis de factores (FA).

-  **3. Determinaci√≥n del n√∫mero de factores **

- Criterio de autovalores > 1.

- An√°lisis del gr√°fico de sedimentaci√≥n (scree plot).

- Criterios te√≥ricos.

-  **4. Rotaci√≥n **

- Varimax (ortogonal) o Promax (oblicua) para interpretar mejor los factores.

-  **5. Interpretaci√≥n **

- ¬øQu√© variables est√°n m√°s asociadas con qu√© factor?

- **En R Studio **

-  **0. Apertura de la base de datos **

```{r}

```


## **‚úÖ 2. An√°lisis Factorial Confirmatorio (AFC)**


Es una t√©cnica confirmatoria, basada en un modelo te√≥rico o hip√≥tesis previa. Aqu√≠ ya sabes cu√°ntos factores hay y qu√© √≠tems deber√≠an cargar en cada factor, y deseas comprobar si los datos emp√≠ricos validan ese modelo.

- üéØ Objetivo:
Validar un modelo factorial espec√≠fico y estimar qu√© tan bien se ajusta a los datos.


- üß™ ¬øCu√°ndo se usa?

Cuando el instrumento ya fue dise√±ado con base te√≥rica.
Para validar escalas ya existentes.
En etapas avanzadas de investigaci√≥n cuantitativa.

- üß∞ M√©todos comunes:

- Estimaci√≥n por M√°xima verosimilitud (ML) o m√©todos robustos.
- Evaluaci√≥n del ajuste del modelo:
- œá¬≤ (Chi cuadrado): idealmente no significativo.
- CFI, TLI: > 0.90
- RMSEA: < 0.08
- SRMR: < 0.08

- Se puede implementar con lavaan o sem en R.

```{r}
library(rio)
data=import("Peru2023.sav")
#names(data)
```

- Seleccionamos las variables que emplearemos

```{r,message=FALSE}
library(dplyr)
confianza=data %>% 
  select(b12,b13,b18,b21,b21a,b31,b32,b37)

```


- Omitimos los NA


```{r}
confianza=na.omit(confianza)
```

- Calculamos la matriz de correlaciones

```{r}
matriz_correlaciones=cor(confianza)
```


- Gr√°fico de Matriz de correlaciones

```{r,message=FALSE, warning=FALSE}
library(corrplot)
corrplot(matriz_correlaciones,method = "circle",typer="upper")
```

-

```{r,message=FALSE, warning=FALSE}
library(corrplot)
corrplot(matriz_correlaciones, method = 'number')
```


```{r}
library(psych)
KMO(confianza)
```


```{r}
cortest.bartlett(matriz_correlaciones)
```


```{r}
fa.parallel(confianza,fa="fa",n.iter = 100,show.legend = TRUE)
```

```{r}
eigenvalues=eigen(matriz_correlaciones)$values
```


```{r}
library(tibble)
library(ggplot2)

df_eigen=tibble(
  Factor=1:length(eigenvalues),
  Autovalor=eigenvalues
)
```


```{r}
ggplot(df_eigen, aes(x=Factor, y=Autovalor))+
  geom_line(group=1)+
  geom_point(size=3)+
  geom_hline(yintercept=1, linetype="dashed",color="red")+
  labs(title="Scree plot con ggplot2", x="N√∫mero de factor",y="Autovalor")+theme_minimal()
```

- Seg√∫n el gr√°fico solo se debe calcular un indicador. 
Sin embargo, en haras de la intepretaci√≥n vamos a colocar 2.


```{r}
fa(confianza,nfactors = 2,fm="ml")
```

Intrepetamos seg√∫n las cargas factoriales mayores a 2.

```{r}
factores2=fa(confianza,nfactors = 2,fm="ml",rotate = "varimax")
factores2
```


```{r}
scores=factores2$scores
```

```{r}
data2=cbind(confianza,scores)
```

```{r,message=TRUE}
library(scales)
data2$Confianza_RPoliticas=rescale(data2$ML1, to=c(0,100))

data2$Confianza_Represion=rescale(data2$ML2, to=c(0,100))
```


<br></br>

</style>

<a href="">
  <button>Descargar la base de datos</button>
</a>

<br></br> [Go to page beginning](#beginning)

